<script>
function setProduction() {
    showLoading();
    google.script.run
        .withSuccessHandler((result) => {
            updateStatus('ğŸŸ¢ æœ¬ç•ªç”¨(1æ™‚é–“ã”ã¨)');
            showMessage('æœ¬ç•ªç”¨(1æ™‚é–“ã”ã¨)ã‚’è¨­å®šã—ã¾ã—ãŸã€‚');
        })
        .withFailureHandler((error) => {
            showMessage('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message, true);
        })
        .setupProductionTrigger();
}

function setTest() {
    showLoading();
    google.script.run
        .withSuccessHandler((result) => {
            updateStatus('ğŸ”¶ æ¤œè¨¼ç”¨(1åˆ†ã”ã¨)');
            showMessage('æ¤œè¨¼ç”¨(1åˆ†ã”ã¨)ã‚’è¨­å®šã—ã¾ã—ãŸã€‚');
        })
        .withFailureHandler((error) => {
            showMessage('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message, true);
        })
        .setupTestTrigger();
}

function deleteTrigger() {
    showLoading();
    google.script.run
        .withSuccessHandler((result) => {
            updateStatus('âŒ æœªè¨­å®š');
            showMessage('å®šæœŸé€šçŸ¥ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚');
        })
        .withFailureHandler((error) => {
            showMessage('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message, true);
        })
        .removeScheduledNotificationTrigger();
}

function updateStatus(newStatus) {
    document.getElementById('status').innerHTML = '<strong>ç¾åœ¨ã®çŠ¶æ…‹:</strong> ' + newStatus;
}

function showMessage(text, isError) {
    var messageDiv = document.getElementById('message');
    messageDiv.innerHTML = text;
    messageDiv.classList.remove('hidden');
    
    if (isError) {
        messageDiv.classList.add('error');
    } else {
        messageDiv.classList.remove('error');
    }
    
    hideLoading();
}

function showLoading() {
    var buttons = document.getElementById('buttons');
    buttons.innerHTML = '<p class="loading">è¨­å®šä¸­...</p>';
}

function hideLoading() {
    // ãƒœã‚¿ãƒ³ã¯éè¡¨ç¤ºã®ã¾ã¾ï¼ˆè¨­å®šå®Œäº†å¾Œã¯é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³ã®ã¿è¡¨ç¤ºï¼‰
}
</script>
